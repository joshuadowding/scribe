<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">

    <link type="text/css" rel="stylesheet" href="../../css/index.css">
    <link type="text/css" rel="stylesheet" href="../../lib/fonts/inter/inter.css">
  </head>
  <body>
    <div class="wizard-wrapper">
      <div class="page-wrapper">
        <div class="page show" id="welcome-page">
          <div class="welcome-page">
            <div class="welcome-title">
              <h1 class="title">Welcome.</h1>
              <p class="tagline">Create a new project, or load a previous one.</p>
            </div>
            <div class="welcome-options">
              <input class="button" type="button" id="new-project" value="New Project" />
              <input class="button" type="button" id="load-project" value="Load Project" />
            </div>
          </div>
        </div>
        <div class="page" id="project-page">
          <form class="input-form">
            <div class="input-col">
              <div class="input-row">
                <label for="input-name">Project Name:</label>
                <input class="text" type="text" id="input-name" required />
              </div>
              <div class="input-row">
                <label for="input-author">Project Author:</label>
                <input class="text" type="text" id="input-author" required />
              </div>
              <div class="input-row">
                <label for="input-path-choose">Project Location:</label>
                <input class="button" type="button" id="input-path-choose" value="Choose Location" />
                <input class="text" type="hidden" id="input-path" value="" />
              </div>
            </div>
            <div class="control-row">
              <input class="button" type="button" id="page-back" value="Back" />
              <input class="button tint" type="submit" value="Finish" />
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Fix: https://github.com/electron/electron/issues/345 -->
    <script type="text/javascript" src="../../lib/jquery-3.5.1.min.js" onload="window.$ = window.jQuery = module.exports;"></script>

    <script type="text/javascript">
      const ipc = require('electron').ipcRenderer;
      const theme = require('../../js/main/helpers/theme');

      ipc.on('choose-theme', (event, message) => {
        theme.chooseTheme(message);
      });

      ipc.on('path-chosen', (event, message) => {
        $('#input-path').val(message);
        $('#input-path-choose').val(message);
      });

      $(document).ready(function() {
        $('.input-form').submit(function(event) {
          event.preventDefault();

          let project = new Map();
          project.set('project-name', $('#input-name').val()); // TODO: Clean input (important).
          project.set('project-author', $('#input-author').val()); // TODO: Clean input (important).
          project.set('project-path', $('#input-path').val());

          ipc.send('create-project', project);
        });

        $('#new-project').click(function() {
          $('#welcome-page').removeClass('show');
          $('#project-page').addClass('show');
        });

        $('#load-project').click(function(event) {
          event.preventDefault();
          ipc.send('load-project');
        });

        $('#page-back').click(function() {
          $('#welcome-page').addClass('show');
          $('#project-page').removeClass('show');
        });

        $('#input-path-choose').click(function(event) {
          event.preventDefault();
          ipc.send('choose-path');
        });
      });
    </script>
  </body>
</html>
