<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>Scribe</title>

    <link type="text/css" rel="stylesheet" href="../../css/index.css">
  </head>
  <body>
    <div class="wizard-wrapper">
      <div class="page-wrapper">
        <div class="page show" id="welcome-page">
          <input type="button" id="new-project" value="New Project" />
          <input type="button" id="load-project" value="Load Project" />
        </div>
        <div class="page" id="project-page">
          <form class="create-project">
            <label for="input-name">Project Name:</label>
            <input type="text" id="input-name" required />

            <label for="input-author">Project Author:</label>
            <input type="text" id="input-author" required />

            <label for="input-path">Project Location:</label>
            <input type="button" id="input-path-choose" value="Choose..." />
            <input type="hidden" id="input-path" value="" />

            <input type="submit" value="Finish" />
          </form>

          <input type="submit" id="page-back" value="Back" />
        </div>
      </div>
    </div>

    <!-- Fix: https://github.com/electron/electron/issues/345 -->
    <script type="text/javascript" src="../../lib/jquery-3.5.1.min.js" onload="window.$ = window.jQuery = module.exports;"></script>

    <script type="text/javascript">
      const ipc = require('electron').ipcRenderer;
      const theme = require('../../js/renderer/theme');

      ipc.on('choose-theme', (event, message) => {
        theme.chooseTheme(message);
      });

      ipc.on('path-chosen', (event, message) => {
        $('#input-path').val(message);
      });

      $(document).ready(function() {
        $('.create-project').submit(function(event) {
          event.preventDefault();

          let project = new Map();
          project.set('project-name', $('#input-name').val()); // TODO: Clean input (important).
          project.set('project-author', $('#input-author').val()); // TODO: Clean input (important).
          project.set('project-path', $('#input-path').val());

          ipc.send('create-project', project);
        });

        $('#new-project').click(function() {
          $('#welcome-page').removeClass('show');
          $('#project-page').addClass('show');
        });

        $('#page-back').click(function() {
          $('#welcome-page').addClass('show');
          $('#project-page').removeClass('show');
        });

        $('#input-path-choose').click(function(event) {
          event.preventDefault();
          ipc.send('choose-path');
        });
      });
    </script>
  </body>
</html>